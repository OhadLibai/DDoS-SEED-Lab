# Apache HTTP/2 Vulnerability Configuration for Lab
# These settings make the server vulnerable to slow headers attacks
# DO NOT use in production!

# Enable HTTP/2 cleartext 
Protocols h2c http/1.1

# HTTP/2 vulnerability settings - make server VERY vulnerable
H2Direct on
H2MaxSessionStreams 10
H2StreamMaxMemSize 1000000
H2WindowSize 8192

# Connection and timeout settings - make server vulnerable  
Timeout 300
KeepAlive On
KeepAliveTimeout 300
MaxKeepAliveRequests 1000

# Memory and process limits - make server resource-constrained
<IfModule mpm_prefork_module>
    StartServers 1
    MinSpareServers 1  
    MaxSpareServers 2
    MaxRequestWorkers 10
    MaxConnectionsPerChild 100
</IfModule>

<IfModule mpm_worker_module>
    StartServers 1
    MinSpareThreads 5
    MaxSpareThreads 10 
    ThreadsPerChild 5
    MaxRequestWorkers 10
    MaxConnectionsPerChild 100
</IfModule>

# Header limits - vulnerable settings
LimitRequestFieldSize 8192
LimitRequestFields 50
LimitRequestLine 8192

# Server identification for lab
ServerTokens Prod
<IfModule mod_headers.c>
    Header always set Server "Apache/2.4-Lab-Vulnerable"
</IfModule>